mutate(ma.ingest = if_else(ma.ingest, "MA User", "Non-Drug User")) %>%
tbl_summary(by = ma.ingest,
statistic = list(all_continuous() ~ "{mean} ({sd})"),
label = list(dd.total ~ "DDDI Total",
duid.att.risk ~ "DUID Attitude (Risk)",
duid.att.sanction ~ "DUID Attitude (Sanction)",
duid.att.peer ~ "DUID Attitude (Peer)")) %>% add_p() %>%
as_flex_table()
t.summ
# Summary of Data ---------------------------------------------------------
t.summ <- select(dat, -c(id, dd.ne.total, dd.ad.total, dd.rd.total, duid.att.mean)) %>%
mutate(ma.ingest = if_else(ma.ingest, "MA User", "Non-Drug User")) %>%
tbl_summary(by = ma.ingest,
statistic = list(all_continuous() ~ "{mean} ({sd})"),
label = list(dd.total ~ "DDDI Total",
duid.att.risk ~ "DUID Attitude (Risk)",
duid.att.sanction ~ "DUID Attitude (Sanction)",
duid.att.peer ~ "DUID Attitude (Peer)")) %>% add_p() %>%
t.summ
# Summary of Data ---------------------------------------------------------
t.summ <- select(dat, -c(id, dd.ne.total, dd.ad.total, dd.rd.total, duid.att.mean)) %>%
mutate(ma.ingest = if_else(ma.ingest, "MA User", "Non-Drug User")) %>%
tbl_summary(by = ma.ingest,
statistic = list(all_continuous() ~ "{mean} ({sd})"),
label = list(dd.total ~ "DDDI Total",
duid.att.risk ~ "DUID Attitude (Risk)",
duid.att.sanction ~ "DUID Attitude (Sanction)",
duid.att.peer ~ "DUID Attitude (Peer)")) %>% add_p()
t.summ
glimpse(dat)
# Summary of Data ---------------------------------------------------------
t.summ <- select(dat, -c(id, dd.ne.total, duid.att.mean, dd.ad.total, dd.rd.total, duid.att.mean)) %>%
mutate(ma.ingest = if_else(ma.ingest, "MA User", "Non-Drug User")) %>%
tbl_summary(by = ma.ingest,
statistic = list(all_continuous() ~ "{mean} ({sd})"),
label = list(dd.total ~ "DDDI Total",
duid.att.risk ~ "DUID Attitude (Risk)",
duid.att.sanction ~ "DUID Attitude (Sanction)",
duid.att.peer ~ "DUID Attitude (Peer)")) %>% add_p()
t.summ
# Summary of Data ---------------------------------------------------------
t.summ <- select(dat, -c(id, dd.ne.total, duid.att.mean, dd.ad.total, dd.rd.total, duid.att.mean)) %>%
mutate(ma.ingest = if_else(ma.ingest, "MA User", "Non-Drug User")) %>%
tbl_summary(by = ma.ingest,
statistic = list(all_continuous() ~ "{mean} ({sd})"),
label = list(dd.total ~ "DDDI Total",
duid.att.mean ~ "DUID Attitude Mean",
duid.att.risk ~ "DUID Attitude (Risk)",
duid.att.sanction ~ "DUID Attitude (Sanction)",
duid.att.peer ~ "DUID Attitude (Peer)")) %>% add_p()
select(dat, -c(id, dd.ne.total, duid.att.mean, dd.ad.total, dd.rd.total, duid.att.mean)) %>%
mutate(ma.ingest = if_else(ma.ingest, "MA User", "Non-Drug User"))
# Summary of Data ---------------------------------------------------------
t.summ <- select(dat, -c(id, dd.ne.total, dd.ad.total, dd.rd.total)) %>%
mutate(ma.ingest = if_else(ma.ingest, "MA User", "Non-Drug User")) %>%
tbl_summary(by = ma.ingest,
statistic = list(all_continuous() ~ "{mean} ({sd})"),
label = list(dd.total ~ "DDDI Total",
duid.att.mean ~ "DUID Attitude Mean",
duid.att.risk ~ "DUID Attitude (Risk)",
duid.att.sanction ~ "DUID Attitude (Sanction)",
duid.att.peer ~ "DUID Attitude (Peer)")) %>% add_p()
t.summ
summary(nma.lm)
summary(ma.lm)
t.summ
piecewiseSEM::multigroup(model.psem, group = "ma.ingest")
t.summ
dat
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer))
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale")
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5)
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5) +
stat_pvalue_manual(
pwc
)
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5) +
stat_pvalue_manual(
pwc, label = "p.adj"
)
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5)
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5) +
stat_pvalue_manual(
pwc, label = "p.adj",
y.position = c(8, 9 10)
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5) +
stat_pvalue_manual(
pwc, label = "p.adj",
y.position = c(8, 9, 10)
)
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5) +
stat_pvalue_manual(
pwc, label = "p.adj",
y.position = c(8, 10, 9)
)
glimpse(dat)
glimpse(dat)
subscales.df %>%
mutate(dd.subscale = factor(dd.subscale, levels = c("dd.ad.total", "dd.ne.total", "dd.rd.total"))) %>%
ggboxplot(x = "dd.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(
pwc, label = "p.adj",
y.position = c(45, 50, 57),
size = 3
)
?ggboxplot
subscales.df %>%
mutate(dd.subscale = factor(dd.subscale, levels = c("dd.ad.total", "dd.ne.total", "dd.rd.total"))) %>%
ggboxplot(x = "dd.subscale", y = "value", width = 0.5, color = "ma.ingest") +
stat_pvalue_manual(
pwc, label = "p.adj",
y.position = c(45, 50, 57),
size = 3
)
subscales.df
dat %>%
mutate(dd.subscale = factor(dd.subscale, levels = c("dd.ad.total", "dd.ne.total", "dd.rd.total"))) %>%
ggboxplot(x = "dd.subscale", y = "value", width = 0.5, color = "ma.ingest")
dat %>%
mutate(dd.subscale = factor(dd.subscale, levels = c("dd.ad.total", "dd.ne.total", "dd.rd.total")))
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(
pwc, label = "p.adj",
y.position = c(8, 10, 9)
)
?stat_pvalue_manual
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(
pwc, x = "ma.ingest", label = "p.adj",
y.position = c(8, 10, 9)
)
#### Attitudes boxplot ####
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(
pwc, label = "p.adj",
y.position = c(8, 10, 9)
)
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(
pwc, label = "p.adj",
y.position = c(8, 10, 9)
)
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
ggboxplot(x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(
stat.test, x = "att.subscale", label = "p.adj",
y.position = c(8, 10, 9)
)
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
t_test(value ~ ma.ingest)
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
t_test(value ~ ma.ingest)
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
t_test(value ~ ma.ingest)
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest)
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest)
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest) %>%
adjust_pvalue()
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest) %>%
adjust_pvalue()
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj")
dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj")
#### Attitudes boxplot ####
stat.test <- dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj")
#### Attitudes boxplot ####
stat.test <- dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer"))) %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj")
ggboxplot(dat, x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(stat.test)
ggboxplot(dat, x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(stat.test, x = "att.subscale")
#### Attitudes boxplot ####
dat.long <- dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer")))
stat.test <-  dat.long
stat.test
dat.long
group_by(att.subscale) %>%
t_test(value ~ ma.ingest)
dat.long
dat.long
group_by(att.subscale)
#### Attitudes boxplot ####
dat.long <- dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer")))
dat.long
group_by(att.subscale)
dat.long
dat.long %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj")
stat.test <- dat.long %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj")
ggboxplot(dat.long, x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(stat.test, x = "att.subscale")
ggboxplot(dat.long, x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(stat.test, x = "att.subscale", y.position = c(8, 9, 10))
ggboxplot(dat.long, x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(stat.test, x = "att.subscale", y.position = 8)
ggboxplot(dat.long, x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(pwc, x = "att.subscale", y.position = 8)
ggboxplot(dat.long, x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(stat.test, x = "att.subscale", y.position = 8)
stat.test
ggboxplot(dat.long, x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(stat.test, x = "att.subscale", y.position = 8, label = "p.adj")
stat.test <- dat.long %>%
group_by(att.subscale) %>%
t_test(value ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj") %>%
mutate(p.adj = scales::pvalue(p.adj))
stat.test
ggboxplot(dat.long, x = "att.subscale", y = "value", width = 0.5, fill = "ma.ingest") +
stat_pvalue_manual(stat.test, x = "att.subscale", y.position = 8, label = "p.adj")
summary(ma.lm)
ndu.lm
nma.lm
summary(nma.lm)
summary(nma.lm) %>% tidy()
duid.att.df %>% filter(id %in% dat$id)
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(dd.df, by = id)
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(dd.df)
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(dd.df, by = "id")
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(dd.df, by = "id") %>%
ggplot(aes(x = duid.att.sanction, y = dd.total, fill = ma.ingest)) +
geom_poin()
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(dd.df, by = "id") %>%
ggplot(aes(x = duid.att.sanction, y = dd.total, fill = ma.ingest)) +
geom_point()
duid.att.sanctglimpse(duid.att.df)
glimpse(duid.att.df)
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(dd.df, by = "id")
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(dd.df, by = "id") %>% glimpse()
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(select(dd.df, -ma.ingest), by = "id") %>%
ggplot(aes(x = duid.att.sanction, y = dd.total, fill = ma.ingest)) +
geom_point()
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(select(dd.df, -ma.ingest), by = "id") %>%
ggplot(aes(x = duid.att.sanction, y = dd.total)) +
geom_point() +
facet_wrap(~ma.ingest)
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(select(dd.df, -ma.ingest), by = "id") %>%
ggplot(aes(x = duid.att.sanction, y = dd.total)) +
geom_point() +
facet_wrap(~ma.ingest, scales = "free")
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(select(dd.df, -ma.ingest), by = "id") %>%
ggplot(aes(x = duid.att.sanction, y = dd.total)) +
geom_point() +
facet_wrap(~ma.ingest, scales = "free") %>% theme_light()
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(select(dd.df, -ma.ingest), by = "id") %>%
ggplot(aes(x = duid.att.sanction, y = dd.total)) +
geom_point() +
facet_wrap(~ma.ingest, scales = "free") + theme_light()
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(select(dd.df, -ma.ingest), by = "id") %>%
ggplot(aes(x = duid.att.sanction, y = dd.total)) +
geom_jitter(height = 0, width = 0.2) +
facet_wrap(~ma.ingest, scales = "free") + theme_light()
#### Exploring Sanctions ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(select(dd.df, -ma.ingest), by = "id") %>%
ggplot(aes(x = duid.att.sanction, y = dd.total)) +
geom_jitter(height = 0, width = 0.02) +
facet_wrap(~ma.ingest, scales = "free") + theme_light()
stat.test
stat.test %>% view
#### Exploring Peer Attitudes ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(select(dd.df, -ma.ingest), by = "id") %>%
ggplot(aes(x = duid.att.peer, y = dd.total)) +
geom_jitter(height = 0, width = 0.02) +
facet_wrap(~ma.ingest, scales = "free") + theme_light()
### Exploring Risk Attitudes ####
duid.att.df %>% filter(id %in% dat$id) %>%
left_join(select(dd.df, -ma.ingest), by = "id") %>%
ggplot(aes(x = duid.att.risk, y = dd.total)) +
geom_jitter(height = 0, width = 0.02) +
facet_wrap(~ma.ingest, scales = "free") + theme_light()
#### Load ####
if(!"packages" %in% ls()){
source("scripts/load-packages.R")
}
source("scripts/functions.R")
load("objects/all-objects.RData")
#### Attitudes boxplot ####
dat.long <- dat %>%
pivot_longer(cols = c(duid.att.risk, duid.att.sanction, duid.att.peer), names_to = "att.subscale") %>%
mutate(
# att.subscale = factor(att.subscale, levels = c("duid.att.risk", "duid.att.sanction", "duid.att.peer")),
att.subscale = case_when(
att.subscale == "duid.att.risk" ~ "Risks",
att.subscale == "duid.att.sanction" ~ "Sanctions",
att.subscale == "duid.att.peer" ~ "Peer Attitudes"
),
group = if_else(ma.ingest, "Methamphetamine Users", "Non-Drug Users"))
stat.test <- dat.long %>%
group_by(att.subscale) %>%
t_test(value ~ group) %>%
adjust_pvalue() %>%
add_significance("p.adj") %>%
mutate(p.adj = scales::pvalue(p.adj))
p.att.score <- ggboxplot(dat.long, x = "att.subscale", y = "value", width = 0.5, fill = "group") +
stat_pvalue_manual(stat.test, x = "att.subscale", y.position = 7.5, label = "p.adj") +
labs(fill = element_blank(),
x = "Attitude Factor",
y = "Score") +
scale_fill_brewer(palette = "OrRd") +
scale_y_continuous(breaks = seq(2, 7, 1)) +
theme(axis.title = element_text(face = 'bold'))
# Summary of Data ---------------------------------------------------------
t.summ <- select(dat, -c(id, dd.ne.total, dd.ad.total, dd.rd.total)) %>%
mutate(ma.ingest = if_else(ma.ingest, "MA User", "Non-Drug User")) %>%
tbl_summary(by = ma.ingest,
statistic = list(all_continuous() ~ "{mean} ({sd})"),
label = list(dd.total ~ "DDDI Total",
duid.att.mean ~ "DUID Attitude Mean",
duid.att.risk ~ "DUID Attitude (Risk)",
duid.att.sanction ~ "DUID Attitude (Sanction)",
duid.att.peer ~ "DUID Attitude (Peer)")) %>% add_p()
t.summ
#### T test between groups for DD ####
dat %>% t_test(dd.total ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj") %>%
mutate(p.adj = scales::pvalue(p.adj))
#### T test between groups for DD ####
dat %>% t_test(dd.total ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj") %>%
mutate(p.adj = scales::pvalue(p.adj)) %>% broom::tidy()
#### T test between groups for DD ####
dat %>% t_test(dd.total ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj") %>%
mutate(p.adj = scales::pvalue(p.adj))
#### T test between groups for DD ####
dat %>% t_test(dd.total ~ ma.ingest) %>%
adjust_pvalue() %>%
add_significance("p.adj") %>%
mutate(p.adj = scales::pvalue(p.adj))
?t.test
t.test(dd.total ~ ma.ingest, data = dat)
dat %>% count(ma.ingest)
#### Piecewise SEM  ####
# (basically does all the above stuff in one go lol)
model.psem <- piecewiseSEM::psem(lm(dd.total ~ duid.att.risk + duid.att.sanction + duid.att.peer, dat))
model.psem
piecewiseSEM::multigroup(model.psem, group = "ma.ingest")
#### Free & Constrained Models ####
# Free Model
mgp.model <- "dd.total ~ duid.att.risk + duid.att.sanction + duid.att.peer"
mgp.free <- sem(mgp.model, data = dat, group = "ma.ingest")
# Constrained Model
mgp.constrained <- sem(mgp.model, dat, group = "ma.ingest", group.equal = c("intercepts", "regressions"))
# Comparing two models
anova(mgp.free, mgp.constrained) #%>% broom::tidy()
summary(mgp.constrained)
#### Comparing single constraints ####
# Risk
mgp.risk.model <- c("dd.total ~ c(b1, b1) * duid.att.risk + duid.att.sanction + duid.att.peer")
mgp.risk <- sem(mgp.risk.model, dat, group = "ma.ingest")
anova(mgp.free, mgp.risk)
anova(mgp.free, mgp.risk)
# Sanction
mgp.sanction.model <-  c("dd.total ~ c(b1, b1) * duid.att.sanction + duid.att.risk + duid.att.peer")
mgp.sanction <- sem(mgp.sanction.model, dat, group = "ma.ingest")
anova(mgp.free, mgp.sanction)
anova(mgp.free, mgp.sanction)
# Peer
mgp.peer.model <- c("dd.total ~ c(b1, b1) * duid.att.peer + duid.att.risk + duid.att.sanction")
mgp.peer <- sem(mgp.peer.model, dat, group = "ma.ingest")
anova(mgp.free, mgp.peer)
piecewiseSEM::multigroup(model.psem, group = "ma.ingest")
lm.ndu %>% tidy()
lm.ndu %>% broom::tidy()
lm.ma %>% tidy()
p.att.score
p.att.score <- ggboxplot(dat.long, x = "att.subscale", y = "value", width = 0.5, fill = "group") +
stat_pvalue_manual(stat.test, x = "att.subscale", y.position = 7.5, label = "p.adj") +
labs(fill = element_blank(),
x = "Attitude Factor",
y = "Score (Higher = More Favourable)") +
scale_fill_brewer(palette = "OrRd") +
scale_y_continuous(breaks = seq(2, 7, 1)) +
theme(axis.title = element_text(face = 'bold'))
ggsave(p.att.score, width = 900, height = 700, units = 'px', dpi = 95, filename = "output/attitude-boxplot.png")
git status
usethis::create_from_github("https://github.com/ajmackay/AzTools.git")
R.version
installr::updateR()
